<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>5.4. Proxying Traditional DNS to DNS over TLS</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="5.4. Proxying Traditional DNS to DNS over TLS"/>
  <meta name="product" content="DNS over HTTPS / DNS over TLS"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="None"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="DNS over HTTPS / DNS over TLS" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.4. Proxying Traditional DNS to DNS over TLS &#8212; DNS over HTTPS / DNS over TLS  documentation</title>
    
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5_agility_theme.css" type="text/css" />
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="/assets/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="/assets/css/index.css" type="text/css" />
    <link rel="stylesheet" href="/assets/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="/assets/css/CoveoFullSearch.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.5. Proxying Traditional DNS queries to DNS over HTTPS" href="../module4/module4.html" />
    <link rel="prev" title="5.3. Proxying DNS over TLS Queries to Traditional DNS" href="../module2/module2.html" /> 
  </head>
  <body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      <!-- javascript code to maintain the sidebar scroll positon when loaded -->
      <script type="text/javascript">
        $(function() {
          if (localStorage.tempScrollTop) {
            $('#sidebar').scrollTop(localStorage.tempScrollTop);
          }
        });
        $('#sidebar').on("scroll", function() {
          localStorage.setItem("tempScrollTop", $('#sidebar').scrollTop());
        });
      </script>
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>DNS over HTTPS / DNS over TLS  </h5>
        
<div id="searchbox" role="search">
  <form class="search" action="../../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topology.html">2. Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components.html">3. Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../access.html">4. Accessing the Lab</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../class1.html">5. Lab Goals</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../module0/module0.html">5.1. BIG-IP Configuration Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module1/module1.html">5.2. Proxying DNS over HTTPS Queries to Traditional DNS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module2/module2.html">5.3. Proxying DNS over TLS Queries to Traditional DNS</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.4. Proxying Traditional DNS to DNS over TLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module4/module4.html">5.5. Proxying Traditional DNS queries to DNS over HTTPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources.html">5.6. Additional Resources</a></li>
</ul>
</li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">5.4. Proxying Traditional DNS to DNS over TLS</a><ul>
<li><a class="reference internal" href="#test-driving-traditional-dns-to-dns-over-tls">5.4.1. Test Driving Traditional DNS to DNS over TLS</a></li>
<li><a class="reference internal" href="#viewing-statistics-for-dns-to-dot">5.4.2. Viewing Statistics for DNS-to-DoT</a></li>
<li><a class="reference internal" href="#capturing-traditional-dns-to-dns-over-tls-traffic">5.4.3. Capturing Traditional DNS to DNS over TLS Traffic</a></li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
            <nav class="site-breadcrumb-nav site-nav">
          <ul class="site-breadcrumb-list">
            <li class="breadcrumb-item"><button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>&#x20 <a href="/">Community Training Classes &amp; Labs</a> &gt; <a href="../../index.html">DNS over HTTPS / DNS over TLS </a> &gt; 5.4. Proxying Traditional DNS to DNS over TLS</li>
          </ul>
      </nav>
      
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="proxying-traditional-dns-to-dns-over-tls">
<h1>5.4. Proxying Traditional DNS to DNS over TLS<a class="headerlink" href="#proxying-traditional-dns-to-dns-over-tls" title="Permalink to this headline">¶</a></h1>
<p>In this section of the lab, we’re going to run DoT in the opposite
direction, taking traditional DNS requests and translating them into DoT
requests. This is done as simply as the DoT-to-DNS; we simply take the
incoming DNS connection (UDP or TCP) and encapsulate it in TLS using a
server-side SSL profile.</p>
<div class="section" id="test-driving-traditional-dns-to-dns-over-tls">
<span id="test-drive-2"></span><h2>5.4.1. Test Driving Traditional DNS to DNS over TLS<a class="headerlink" href="#test-driving-traditional-dns-to-dns-over-tls" title="Permalink to this headline">¶</a></h2>
<p>On the Ubuntu jump host, issue the following command:</p>
<p>kdig &#64;10.1.10.101 <a class="reference external" href="http://www.yahoo.com">www.yahoo.com</a></p>
<p>You should receive a successful response as shown below:</p>
<p><a class="reference internal" href="../../_images/image173.png"><img alt="image17.png" src="../../_images/image173.png" style="width: 7.5in; height: 4.47917in;" /></a></p>
</div>
<div class="section" id="viewing-statistics-for-dns-to-dot">
<span id="viewing-statistics-1"></span><h2>5.4.2. Viewing Statistics for DNS-to-DoT<a class="headerlink" href="#viewing-statistics-for-dns-to-dot" title="Permalink to this headline">¶</a></h2>
<p>Back in the BIG-IP web UI, you will see that the VIP is receiving
connections:</p>
<p><a class="reference internal" href="../../_images/image183.png"><img alt="image18.png" src="../../_images/image183.png" style="width: 7.5in; height: 4.47917in;" /></a></p>
<p>Issuing the same command with TCP will increment the counters on the
corresponding virtual server:</p>
<p>kdig +tcp &#64;10.1.10.101 <a class="reference external" href="http://www.f5.com">www.f5.com</a></p>
<p><a class="reference internal" href="../../_images/image193.png"><img alt="image19.png" src="../../_images/image193.png" style="width: 7.5in; height: 3.19271in;" /></a></p>
<p>Again, nothing super-fancy is happening in this configuration.
Conventional F5 logging methods can be used for this traffic so we won’t
cover that in this lab.</p>
</div>
<div class="section" id="capturing-traditional-dns-to-dns-over-tls-traffic">
<span id="packet-capture-2"></span><h2>5.4.3. Capturing Traditional DNS to DNS over TLS Traffic<a class="headerlink" href="#capturing-traditional-dns-to-dns-over-tls-traffic" title="Permalink to this headline">¶</a></h2>
<p>We can see the 53/853 exchange on a packet capture using the same
<strong>tcpdump</strong> command we used in the DoT-to-DNS section, as the IP/ports
are simply being switched around:</p>
<p>tcpdump -nni 0.0 (host 10.1.20.10 or 10.1.1.6) and (port 53 or port 853)</p>
<p>You will see the 53 and 853 connections in the output, as shown below.</p>
<p><a class="reference internal" href="../../_images/image203.png"><img alt="image20.png" src="../../_images/image203.png" style="width: 7.5in; height: 3.74479in;" /></a></p>
<p>Stop your capture before moving on to the next section. This concludes
the DNS-to-DoT section.</p>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="../module2/module2.html" title="5.3. Proxying DNS over TLS Queries to Traditional DNS" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="../module4/module4.html" title="5.5. Proxying Traditional DNS queries to DNS over HTTPS" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <script src="/assets/js/clouddocs.js"></script>
  <script src="/assets/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>