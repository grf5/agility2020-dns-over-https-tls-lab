
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2.2.1. Detecting and Preventing System DoS and DDoS Attacks &#8212; F5 BIG-IP DDoS and DNS DoS Protections  documentation</title>
    
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5_agility_theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.3. Appendix" href="../module3/module3.html" />
    <link rel="prev" title="2.2. Module 2 – Detecting and Preventing System DoS and DDoS Attacks" href="module2.html" />
<!--
# Copyright 2017 F5 Networks
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
-->
<link href="https://cdn.f5.com/favicon.ico" rel="icon">
<script src="https://use.fontawesome.com/21fb8a09c3.js"></script>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>
  <body>
  <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="row corp-header">
      <div class="container corp-header">
        <div class="container corp-menu">
          <ul>
            <li><a href="https://f5.com" class="internalLink">F5.com</a></li>
            <li><a href="https://support.f5.com">Support</a></li>
            <li><a href="https://devcentral.f5.com">Community</a></li>
            <li><a href="https://github.com/F5Networks">GitHub</a></li>
            <li><a href="https://f5.com/about-us/careers">Careers</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="row pageHeader">
      <div class="container stat">
        <div class="col-xs-12 stat">
          <a class="internalLink" href="https://f5.com">
            <img class="logo" src="https://cdn.f5.com/websites/support/assets/images/logo.svg" width="50" height="44" alt="F5 Networks" title="F5 Networks" border="0">
          </a>
            <ul id="MainMenu" class="main-menu">
              <li>
                <a href="#">Products
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>

                <div class="menu-panel soft-hide" id="ProductsSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third"><span class="a-mm-h">Connectors</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/products/connectors/marathon-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 Marathon BIG-IP Controller</a></li>
                          <li><a href="http://clouddocs.f5.com/products/connectors/marathon-asp-ctlr/latest" data-link-type="Nav: Mega">F5 Marathon ASP Controller</a></li>
                          <li><a href="http://clouddocs.f5.com/products/connectors/k8s-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 Kubernetes BIG-IP Controller</a></li>
                          <li><a href="http://clouddocs.f5.com/products/connectors/f5-kube-proxy/latest" data-link-type="Nav: Mega">F5 Kubernetes Proxy</a></li>
                        </ul>
                        <!--span class="seemore"><a data-link-type="Nav: Mega" href="/products/connectors">See all </a></--span-->
                      </li>
                      <li class="divider"></li>
                      <li class="third"><span class="a-mm-h">Application Service Proxy</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/products/asp/latest" data-link-type="Nav: Mega">F5 Application Service Proxy</a></li>
                        </ul>
                        <!--span class="seemore"><a href="/products/">See all </a></span-->
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
              <li>
                <a href="#">Container Integrations
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>

                <div class="menu-panel soft-hide" id="ContainersSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third"><span class="a-mm-h">Container Integrations</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/containers/latest/marathon/" data-link-type="Nav: Mega">Mesos Marathon</a></li>
                          <li><a href="http://clouddocs.f5.com/containers/latest/kubernetes/" data-link-type="Nav: Mega">Kubernetes</a></li>
                          <li><a href="http://clouddocs.f5.com/containers/latest/openshift/" data-link-type="Nav: Mega">RedHat OpenShift</a></li>
                        </ul>
                        <span class="seemore"><a data-link-type="Nav: Mega" href="http://clouddocs.f5.com/containers/latest">View details </a></span>
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
              <li>
                <a href="#">Clouds
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>

                <div class="menu-panel soft-hide" id="CloudsSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third"><span class="a-mm-h">Cloud Integrations</span>
                        <ul>
                          <li><a href="http://clouddocs.f5.com/cloud/openstack/" data-link-type="Nav: Mega">OpenStack</a></li>
                        </ul>
                        <!--span class="seemore"><a data-link-type="Nav: Mega" href="/cloud/">See all </a></span-->
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
              <li>
                <a href="#">Resources
                  <span class="indicator"><span class="arrow-up"></span></span>
                </a>
                <div class="menu-panel soft-hide" id="UPCProgramSubmenu">
                  <div class="container">
                    <ul class="submenu col-sm-11">
                      <li class="third">
                        <span class="a-mm-h">Downloads</span>
                        <ul>
                          <li><a target="_blank" data-link-type="Nav: Mega" href="https://hub.docker.com/r/f5networks/" class="internalLink">Docker Hub</a></li>
                          <li><a target="_blank" data-link-type="Nav: Mega" href="https://store.docker.com/images/f5networks" class="internalLink">Docker Store</a></li>
                        </ul>
                      </li>
                      <li class="divider"></li>

                      <li class="third">
                        <span class="a-mm-h">OpenSource</span>
                        <ul>
                          <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5Networks" class="internalLink">GitHub</a></li>
                        </ul>
                      </li>
                      <li class="divider"></li>

                      <li class="third">
                        <a href="//university.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega">F5 University</a>
                        <ul>
                          <li>
                            <p>Get up to speed with free self-paced courses</p>
                          </li>
                        </ul>
                        <a data-ng-href="https://devcentral.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega" href="https://devcentral.f5.com">DevCentral</a>
                        <ul>
                          <li>
                            <p>Join the community of 250,000+ technical peers</p>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </div>
              </li>
            </ul>
        </div>
      </div>
    </div>
  </div> <!-- /container-fluid -->
</nav>

  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-3 col-md-3 sidebar">
         <h4><a href="../../">F5 BIG-IP DDoS and DNS DoS Protections </a></h4>
<div id="searchbox" style="display: none" role="search">
  <form class="search" action="../../search.html" method="get">
    <div>
      <input type="text" name="q" placeholder="Search" style="padding-left: 6px;"/>
      <!-- <input type="submit" value="Go" style="margin-top: 4px;"/> -->
      <button type="submit" class="btn btn-primary btn-xs">Go</button>
    </div>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <p class="caption">
   <span class="caption-text">Current Page</span>
  </p>
  <ul>
<li><a class="reference internal" href="#">2.2.1. Detecting and Preventing System DoS and DDoS Attacks</a><ul>
<li><a class="reference internal" href="#configure-logging">2.2.1.1. Configure Logging</a></li>
<li><a class="reference internal" href="#simulating-a-christmas-tree-packet-attack">2.2.1.2. Simulating a Christmas Tree Packet Attack</a></li>
<li><a class="reference internal" href="#simulating-a-tcp-syn-ddos-attack">2.2.1.3. Simulating a TCP SYN DDoS Attack</a></li>
</ul>
</li>
<li><a class="reference internal" href="#preventing-global-dos-sweep-and-flood-attacks">2.2.2. Preventing Global DoS Sweep and Flood Attacks</a><ul>
<li><a class="reference internal" href="#single-endpoint-sweep">2.2.2.1. Single Endpoint Sweep</a></li>
<li><a class="reference internal" href="#single-endpoint-flood">2.2.2.2. Single Endpoint Flood</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">2.2.3. Conclusion</a></li>
</ul>


<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">1. DDoS and DNS Protocol Attacks Lab Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../class1.html">2. Class - F5 BIG-IP DDoS and DNS DoS Protections</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../module1/module1.html">2.1. Module 1 – Detecting and Preventing DNS DoS Attacks on a Virtual Server</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="module2.html">2.2. Module 2 – Detecting and Preventing System DoS and DDoS Attacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module3/module3.html">2.3. Appendix</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="module2.html"
                        title="previous chapter">2.2. Module 2 – Detecting and Preventing System DoS and DDoS Attacks</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../module3/module3.html"
                        title="next chapter">2.3. Appendix</a></p>
        
      </div>
      <div class="col-md-offset-3 col-sm-offset-3 main">
        <h4>
          <a href="/">Community Training Classes &amp; Labs</a> &gt; <a href="../../index.html">F5 BIG-IP DDoS and DNS DoS Protections</a>
          <span class="right"><a href="../../genindex.html">Index</a></span>
        </h4>
        
  <div class="section" id="detecting-and-preventing-system-dos-and-ddos-attacks">
<h1>2.2.1. Detecting and Preventing System DoS and DDoS Attacks<a class="headerlink" href="#detecting-and-preventing-system-dos-and-ddos-attacks" title="Permalink to this headline">¶</a></h1>
<div class="section" id="configure-logging">
<h2>2.2.1.1. Configure Logging<a class="headerlink" href="#configure-logging" title="Permalink to this headline">¶</a></h2>
<p>Configuring a logging destination will allow you to verify the BIG-IPs
detection and mitigation of attacks, in addition to the built-in
reporting.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong> &gt;
<strong>Device Configuration</strong> &gt; <strong>Properties</strong>.</p>
</li>
<li><p class="first">Under <strong>Log Pubisher</strong>, select <strong>local-db-publisher</strong>.</p>
</li>
<li><div class="first line-block">
<div class="line">Click the <strong>Commit Changes to System</strong> button.</div>
<div class="line"><a class="reference internal" href="../../_images/image32.png"><img alt="image30" src="../../_images/image32.png" style="width: 2.98013in; height: 1.62914in;" /></a></div>
</div>
</li>
</ol>
</div>
<div class="section" id="simulating-a-christmas-tree-packet-attack">
<h2>2.2.1.2. Simulating a Christmas Tree Packet Attack<a class="headerlink" href="#simulating-a-christmas-tree-packet-attack" title="Permalink to this headline">¶</a></h2>
<p>In this example, we’ll set the BIG-IP to detect and mitigate an attack
where all flags on a TCP packet are set. This is commonly referred to as
a Christmas tree packet and is intended to increase processing on
in-path network devices and end hosts to the target.</p>
<p>We’ll use the hping utility to send 25,000 packets to our server, with
random source IPs to simulate a DDoS attack where multiple hosts are
attacking our server. We’ll set the SYN, ACK, FIN, RST, URG, PUSH, Xmas
and Ymas TCP flags.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Bad-Header-TCP</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on the <strong>Bad TCP Flags (All Flags Set)</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ol class="loweralpha">
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: Specify 50</p>
</li>
<li><p class="first">Detection Threshold Percent: Specify 200</p>
</li>
<li><div class="first line-block">
<div class="line">Mitigation Threshold EPS: Specify 100</div>
<div class="line"><a class="reference internal" href="../../_images/image33.png"><img alt="image31" src="../../_images/image33.png" style="width: 2.43392in; height: 2.49669in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: tail -f /var/log/ltm</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following
command on the BASH prompt:</div>
<div class="line">sudo hping3 10.20.0.10 –flood –rand-source –destport 80 -c
25000 –syn –ack –fin –rst –push –urg –xmas –ymas</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">You’ll see the BIG-IP ltm log show that the attack has been
detected:</div>
<div class="line"><a class="reference internal" href="../../_images/image34.png"><img alt="image32" src="../../_images/image34.png" style="width: 4.48611in; height: 0.38889in;" /></a></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">After approximately 60 seconds, press <strong>CTRL+C</strong> to stop the
attack.</div>
<div class="line"><a class="reference internal" href="../../_images/image35.png"><img alt="image33" src="../../_images/image35.png" style="width: 4.43056in; height: 0.97222in;" /></a></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">Return to the BIG-IP web UI. Navigate to <strong>Security</strong> &gt; <strong>Event
Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt; <strong>Events</strong>. Observer the log
entries showing the details surrounding the attack detection and
mitigation.</div>
<div class="line"><a class="reference internal" href="../../_images/image36.png"><img alt="image34" src="../../_images/image36.png" style="width: 5.00000in; height: 1.70833in;" /></a></div>
</div>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Analysis</strong>.
Single-click on the attack ID in the filter list to the right of the
charts and observe the various statistics around the attack.</p>
</li>
</ol>
</div>
<div class="section" id="simulating-a-tcp-syn-ddos-attack">
<h2>2.2.1.3. Simulating a TCP SYN DDoS Attack<a class="headerlink" href="#simulating-a-tcp-syn-ddos-attack" title="Permalink to this headline">¶</a></h2>
<p>In the last example, we crafted a packet that is easily identified as
malicious, as its invalid. We’ll now simulate an attack with traffic
that could be normal, acceptable traffic. The TCP SYN flood attack will
attempt to DDoS a host by sending valid TCP traffic to a host from
multiple source hosts.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device</strong> <strong>Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Flood</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on <strong>TCP Syn Flood</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ol class="loweralpha">
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: 400</p>
</li>
<li><p class="first">Detection Threshold Percent: 500</p>
</li>
<li><div class="first line-block">
<div class="line">Mitigation Threshold EPS: 500</div>
<div class="line"><a class="reference internal" href="../../_images/image37.png"><img alt="image35" src="../../_images/image37.png" style="width: 2.45542in; height: 3.49669in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: tail -f /var/log/ltm</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following
command on the BASH prompt:</div>
<div class="line">sudo hping3 10.20.0.10 –flood –rand-source –destport 80 –syn
-d 120 -w 64</div>
</div>
</li>
<li><p class="first">After about 60 seconds, stop the flood attack by pressing <strong>CTRL +
C</strong>.</p>
</li>
<li><p class="first">Return to the BIG-IP web UI and navigate to <strong>Security</strong> &gt; <strong>Event
Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt; <strong>Events</strong>. Observe the log entries
showing the details surrounding the attack detection and mitigation.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Dashboard</strong>
to view an overview of the DoS attacks and timeline. You can select
filters in the filter pane to highlight the specific attack.</p>
</li>
<li><p class="first">Finally, navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt;
<strong>Analysis</strong>. View detailed statistics around the attack.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="preventing-global-dos-sweep-and-flood-attacks">
<h1>2.2.2. Preventing Global DoS Sweep and Flood Attacks<a class="headerlink" href="#preventing-global-dos-sweep-and-flood-attacks" title="Permalink to this headline">¶</a></h1>
<p>In the last section, the focus was on attacks originating from various
hosts. In this section, we will focus on mitigating flood and sweep
attacks from a single host.</p>
<div class="section" id="single-endpoint-sweep">
<h2>2.2.2.1. Single Endpoint Sweep<a class="headerlink" href="#single-endpoint-sweep" title="Permalink to this headline">¶</a></h2>
<p>The single endpoint sweep is an attempt for an attacker to send traffic
across a range of ports on the target server, typically to scan for open
ports.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Single-Endpoint</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on <strong>Single Endpoint Sweep</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ol class="loweralpha">
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: 150</p>
</li>
<li><p class="first">Mitigation Threshold EPS: 200</p>
</li>
<li><p class="first">Add Source Address to Category: Checked</p>
</li>
<li><p class="first">Category Name: denial_of_service</p>
</li>
<li><p class="first">Sustained Attack Detection Time: 10 seconds</p>
</li>
<li><p class="first">Category Duration Time: 60 seconds</p>
</li>
<li><div class="first line-block">
<div class="line">Packet Type: Move All IPv4 to Selected</div>
<div class="line"><a class="reference internal" href="../../_images/image38.png"><img alt="image36" src="../../_images/image38.png" style="width: 2.79540in; height: 6.25166in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Network Firewall</strong> &gt; <strong>IP
Intelligence</strong> &gt; <strong>Policies</strong>.</p>
</li>
<li><div class="first line-block">
<div class="line">In the <strong>Global Policy</strong> section, change the <strong>IP Intelligence
Policy</strong> to <strong>ip-intelligence</strong>.</div>
<div class="line"><a class="reference internal" href="../../_images/image39.png"><img alt="image37" src="../../_images/image39.png" style="width: 2.56954in; height: 0.91286in;" /></a></div>
</div>
</li>
<li><p class="first">Click <strong>Update</strong>.</p>
</li>
<li><p class="first">Click on the <strong>ip-intelligence</strong> policy in the policy list below.</p>
</li>
<li><p class="first">Create a new Blacklist Matching Policy in the IP Intelligence Policy
Properties section with the following attributes, leaving
unspecified attributes with their default values:</p>
<ol class="loweralpha simple">
<li>Blacklist Category: denial-of-service</li>
<li>Action: drop</li>
<li>Log Blacklist Category Matches: Yes</li>
</ol>
</li>
<li><div class="first line-block">
<div class="line">Click <strong>Add</strong> to add the new Blacklist Matching Policy.</div>
<div class="line"><a class="reference internal" href="../../_images/image40.png"><img alt="image38" src="../../_images/image40.png" style="width: 6.17881in; height: 3.91721in;" /></a></div>
</div>
</li>
<li><p class="first">Click <strong>Update</strong> to save changes to the ip-intelligence policy.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: tail -f /var/log/ltm</p>
</li>
<li><p class="first">On the victim server, start a packet capture with an SSH filter by
issuing sudo tcpdump -nn not port 22</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following
command on the BASH prompt:</div>
<div class="line">sudo hping3 10.20.0.10 –flood –scan 1-65535 -d 128 -w 64 –syn</div>
</div>
</li>
<li><p class="first">You will see the scan find a few open ports on the server, and the
server will show the inbound sweep traffic. However, you will notice
that the traffic to the server stops after a short time (10 seconds,
the configured sustained attack detection time.) Leave the test
running.</p>
</li>
<li><p class="first">After approximately 60 seconds, sweep traffic will return to the
host. This is because the IP Intelligence categorization of the
attack host has expired. After 10 seconds of traffic, the bad actor
is again blacklisted for another 60 seconds.</p>
</li>
<li><p class="first">Stop the sweep attack on the attack host by pressing <strong>CTRL + C</strong>.</p>
</li>
<li><p class="first">Return to the BIG-IP web UI and navigate to <strong>Security</strong> &gt; <strong>Event
Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt; <strong>Events</strong>. Observe the log entries
showing the details surrounding the attack detection and mitigation.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the log entries showing the mitigation of
the sweep attack via the ip-intelligence policy.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>Shun</strong>.
Observe the log entries showing the blacklist adds and deletes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the statistics showing the sweep attack and
mitigation. Change the <strong>View By</strong> drop-down to view the varying
statistics.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Dashboard</strong>
to view an overview of the DoS attacks and timeline. You can select
filters in the filter pane to highlight the specific attack.</p>
</li>
<li><p class="first">Finally, navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt;
<strong>Analysis</strong>. View detailed statistics around the attack.</p>
</li>
</ol>
</div>
<div class="section" id="single-endpoint-flood">
<h2>2.2.2.2. Single Endpoint Flood<a class="headerlink" href="#single-endpoint-flood" title="Permalink to this headline">¶</a></h2>
<p>The single endpoint flood attack is an attempt for an attacker to send a
flood of traffic to a host in hopes of overwhelming a service to a point
of failure. In this example, we’ll flood the target server with ICMP
packets.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Single-Endpoint</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on <strong>Single Endpoint Flood</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ol class="loweralpha">
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: 150</p>
</li>
<li><p class="first">Mitigation Threshold EPS: 200</p>
</li>
<li><p class="first">Add Destination Address to Category: Checked</p>
</li>
<li><p class="first">Category Name: denial_of_service</p>
</li>
<li><p class="first">Sustained Attack Detection Time: 10 seconds</p>
</li>
<li><p class="first">Category Duration Time: 60 seconds</p>
</li>
<li><div class="first line-block">
<div class="line">Packet Type: Move Any ICMP (IPv4) to Selected</div>
<div class="line"><a class="reference internal" href="../../_images/image41.png"><img alt="image39" src="../../_images/image41.png" style="width: 2.41144in; height: 5.43046in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: tail -f /var/log/ltm</p>
</li>
<li><p class="first">We’ll run a packet capture on the victim server to gauge the
incoming traffic. On the victim server, issue the following command:
sudo tcpdump -nn not port 22</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following
command on the BASH prompt:</div>
<div class="line">sudo hping3 10.20.0.10 –faster -c 25000 –icmp</div>
</div>
</li>
<li><p class="first">The attack host will begin flooding the victim server with ICMP
packets. However, you will notice that the traffic to the server
stops after a short time (10 seconds, the configured sustained
attack detection time.)</p>
</li>
<li><p class="first">After approximately 60 seconds, run the attack again. ICMP traffic
will return to the host. This is because the IP Intelligence
categorization of the attack host has expired.</p>
</li>
<li><p class="first">Return to the BIG-IP web UI.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt;
<strong>Events</strong>. Observe the log entries showing the details surrounding
the attack detection and mitigation.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the log entries showing the mitigation of
the sweep attack via the ip-intelligence policy.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>Network</strong> &gt; <strong>IP Intelligence</strong>. Observe the statistics showing the sweep attack and mitigation.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Dashboard</strong> to view an overview of the DoS attacks and timeline. You can select filters in the filter pane to highlight the specific attack.</p>
</li>
<li><p class="first">Finally, navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Analysis</strong>. View detailed statistics around the attack.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="conclusion">
<h1>2.2.3. Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h1>
<p>Congratulations on finishing the lab!</p>
<p>This lab did not cover auto thresholds for protections, nor did we test dynamic signatures. Testing auto thresholds requires a more real-world environment. For suggested testing guidelines for auto thresholds and dynamic signatures, engage your F5 account team.</p>
<p>This concludes the DoS/DDoS portion of the lab. You may now close all sessions, log out of the jump host and log out of the training portal.</p>
<p>Thank you for your time.</p>
</div>


        
		     <div class="row next-prev-btn-row">
           <div class="col-lg-12">
           
		        <a href="module2.html" title="2.2. Module 2 – Detecting and Preventing System DoS and DDoS Attacks" accesskey="p" class="btn btn-primary pull-left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
           
           
              <a href="../module3/module3.html" title="2.3. Appendix" accesskey="n" class="btn btn-primary pull-right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
           
		     </div>
         </div>
        
      </div>
    </div>
  </div>


  <footer>
      <div class="container-fluid">
        <div class="row">
          <div class="content-fluid pre-footer">
            <div class="blocks-container">
              <div class="block">
                <h3>Support Programs</h3>
                <p>Regionally located support centers enable F5 to provide support in a number of languages through native-speaking support engineers.</p>
                <a class="btn internalLink" data-ng-href="https://f5.com/support/support-offerings" target="_blank" href="https://f5.com/support/support-offerings">See more
                  <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
                </a>
              </div>
              <div class="block">
                <h3>Contact Support</h3>
                <p>
                  North America: 1-888-882-7535<br>
                  Outside North America: 800-11-275-435
                </p>
                <a class="btn internalLink" data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" href="https://f5.com/about-us/contact#regional-support">Local Support Numbers
                  <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
                </a>
              </div>
              <div class="block">
                <h3>Feedback and Help</h3>
                <p>Have questions, suggestions, or just want to get something off your chest? Let us know.</p>
                <a class="btn" data-ui-sref="siteFeedback" target="_blank" href="https://support.f5.com/csp/siteFeedback">Leave feedback</a>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="footer">
            <div class="container">
              <div class="col-sm-3 col-md-2">
                <h4>About F5</h4>
                <ul>
                  <li><a data-ng-href="https://f5.com/about-us/contact" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact" class="internalLink">Contact F5</a>
                  </li>
                  <li><a data-ng-href="https://f5.com/about-us/careers" target="_blank" data-link-type="footer" href="https://f5.com/about-us/careers" class="internalLink">Careers</a>
                  </li>
                </ul>
              </div>
              <div class="col-sm-3 col-md-2">
                <h4>Education</h4>
                <ul>
                  <li><a data-ng-href="https://f5.com/education/training" target="_blank" data-link-type="footer" href="https://f5.com/education/training" class="internalLink">Training</a>
                  </li>
                  <li><a data-ng-href="https://f5.com/education/certification" target="_blank" data-link-type="footer" href="https://f5.com/education/certification" class="internalLink">Certification</a>
                  </li>
                  <li><a data-ng-href="https://f5.com/education/training/free-courses" target="_blank" data-link-type="footer" href="https://f5.com/education/training/free-courses" class="internalLink">Free Online Training</a>
                  </li>
                </ul>
              </div>

              <div class="col-sm-3 col-md-2">
                <h4>F5 sites</h4>
                <ul>
                <li><a data-ng-href="https://f5.com" target="_blank" data-link-type="footer" href="https://f5.com" class="internalLink">F5.com</a>
                </li>
                <li><a data-ng-href="https://devcentral.f5.com" target="_blank" data-link-type="footer" href="https://devcentral.f5.com" class="internalLink">Community</a>
                </li>
                <li><a data-ng-href="https://partners.f5.com" target="_blank" data-link-type="footer" href="https://partners.f5.com" class="internalLink">Partners</a>
                </li>
            </ul>
        </div>

        <div class="col-sm-3 col-md-2">
            <h4>Support Tasks</h4>
            <ul>
                <li><a data-ui-sref="mySupport.createServiceRequest" data-link-type="footer" href="https://support.f5.com/csp/my-support/service-request">Create Service Request </a>
                </li>
                <li><a data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact#regional-support" class="internalLink">Contact Support</a>
                </li>
                <li><a data-ui-sref="siteFeedback" target="_blank" data-link-type="footer" href="https://support.f5.com/csp/siteFeedback">Leave feedback [+]</a>
                </li>
            </ul>
        </div>

        <div class="col-xs-12 col-md-3 right">
            <h4>Connect with us</h4>
            <ul class="social_icons">
                <li><a href="//twitter.com/f5networks" target="_blank" data-name="twitter" data-type="" data-prefix="social" data-utf="E032" title="Twitter" class="externalLink"><i class="icon-1x icon-twitter icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a href="//www.linkedin.com/companies/f5-networks" target="_blank" class="linkedin externalLink" title="LinkedIn"><i class="icon-1x icon-linkedin icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a href="//www.facebook.com/f5networksinc" target="_blank" class="facebook externalLink" title="Facebook"><i class="icon-1x icon-facebook icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a href="//www.youtube.com/f5networksinc" target="_blank" class="youtube externalLink" title="YouTube"><i class="icon-1x icon-youtube icon-inverse-circle" data-link-type="footer"></i></a></li>
                <li><a data-ng-href="https://devcentral.f5.com" target="_blank" class="devcentral internalLink" title="DevCentral" href="https://devcentral.f5.com"><i class="icon-1x icon-dc-pos icon-inverse-circle" data-link-type="footer"></i></a></li>
            </ul>
        </div>

        <div class="content-fluid left">
            <div class="col-xs-12">
                <p>
                    © Copyright <span class="ng-binding">2017</span> by F5 Networks, Inc. |
                    <a data-ng-href="https://f5.com/about-us/policies" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies" class="internalLink">Policies</a> |
                    <a data-ng-href="https://f5.com/about-us/policies/trademarks" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies/trademarks" class="internalLink">Trademarks</a>
                </p>
            </div>
        </div>
    </div>
</div>
    </div>
</div>
</footer>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    jQuery.noConflict(true)
  </script>
  </body>
</html>